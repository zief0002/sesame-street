---
title: "Assignment 06"
subtitle: "DICHOTOMOUS CATEGORICAL PREDICTORS"
author: "Answer Key"
date: "`r Sys.Date()`"
description: "This assignment is worth 15 points. Each question is worth 1 point unless otherwise noted."
format:
  html:
    theme: yeti
    mainfont: 'Raleway'
    code-copy: true
    code-fold: true
    highlight-style: zenburn
    df-print: paged
    toc: true
editor: source
---


```{=html}
<style type="text/css">
caption, .table-caption {
  text-align: left;
}
</style>
```

```{r}
#| label: setup
#| message: false
source("../assets/notes-setup.R")

# Load libraries
library(tidyverse)
library(broom)
library(educate)

# Import data
evals = read_csv(file = "https://raw.githubusercontent.com/zief0002/rustic-penguin/main/data/evaluations.csv")

# Fit Part I model and view results
lm.1 = lm(avg_eval ~ 1 + native_english, data = evals)
#tidy(lm.1) # Coefficient-level results
#glance(lm.1) # Model-level results

# Fit Part II model and view results
lm.2 = lm(avg_eval ~ 1 + beauty + num_courses + native_english, data = evals)
#tidy(lm.2) # Coefficient-level results
#glance(lm.3) # Model-level results
```


# Unadjusted Group Differences Model: ANOVA


**1. Write the fitted regression equation.** 

$$
\hat{\mathrm{Average~Evaluation}} = 3.55 + 0.38(\mathrm{Native~English})
$$

<br />

**2. Interpret the intercept coefficient.**

Professors that are non-native English speakers have an average course evaluation of 3.55.

<br />

**3. Interpret the slope coefficient.**

The average course evaluation for professors that are native English speakers is 0.38 points higher than than the average course evaluation for professors that are non-native English speakers.

<br />

**4. In terms of means (not betas), write the null hypothesis (using mathematical notation) associated with the *t*-test of the slope? Be specific.**

$$
H_0: \mu_{\mathrm{English}} = \mu_{\mathrm{Non\mbox{-}English}}
$$

<br />

**5. Based on results of the _t_-test for the slope, what do you conclude about differences in evaluation scores between native and non-native English speaking professors?**

The *t*-test for the slope,$t(92) = 2.15$, $p = 0.034$, suggests that there is a difference in the average course evaluation scores between professors that are native English speakers and those that are non-native English speakers.

<br />

**6. Use the fitted regression equation to estimate (a) the mean course rating for native and (b) the mean course rating for non-native English speakers. Show your work.**

* Native English Speakers*

$$
\begin{split}
\hat{\mathrm{Average~Evaluation}} &= 3.55 + 0.38(1) \\
&= 3.93
\end{split}
$$

* Non-native English Speakers*

$$
\begin{split}
\hat{\mathrm{Average~Evaluation}} &= 3.55 - 0.38(0) \\
&= 3.55
\end{split}
$$

<br />


# Adjusted Group Differences Model: ANCOVA

**7. Write the fitted regression equation.**

$$
\hat{\mathrm{Average~Evaluation}} = 3.30 + 0.15(\mathrm{Beauty}) + 0.07(\mathrm{Number~of~courses}) + 0.28(\mathrm{Native~English})
$$

<br />

**8. Interpret the fitted regression coefficient for `native_english`.**

The average course evaluation for professors that are native English speakers is 0.28 points higher than than the average course evaluation for professors that are non-native English speakers, controlling for differences in professors' beauty and the number of courses with evaluations.

<br />

**9. Compare the size and direction of the difference in course evaluation scores between native and non‐native English speakers in the adjusted model to those from the unadjusted model. How do they compare? Also compare the uncertainty in the estimates.**

The native english coefficients (0.38 vs 0.28) has diminished. The standard errors (0.18 vs. 0.16) are quite similar to one another, although the SE in the controlled model is smaller.

<br />

**10. Write the fitted regression equation for native English speakers. (Note: This equation should only include the effects of beauty and the number of courses for which the professor has evaluations.)**

$$
\hat{\mathrm{Average~Evaluation}} = 3.58 + 0.15(\mathrm{Beauty}) + 0.07(\mathrm{Number~of~courses})
$$

<br />

**11. Write the fitted regression equation for non‐native English speakers. (Note: This equation should only include the effects of beauty and the number of courses for which the professor has evaluations.)**

$$
\hat{\mathrm{Average~Evaluation}} = 3.30 + 0.15(\mathrm{Beauty}) + 0.07(\mathrm{Number~of~courses})
$$

<br />

**12. Compute the *adjusted* mean course rating for native and non-native English speakers (based on professors having an average beauty and an average number of courses). Show your work.**

*Native English Speakers*

$$
\begin{split}
\hat{\mathrm{Average~Evaluation}} &= 3.58 + 0.15(0) + 0.07(4.93) \\
&= 3.93
\end{split}
$$

*Non-native English Speakers*

$$
\begin{split}
\hat{\mathrm{Average~Evaluation}} &= 3.30 + 0.15(0) + 0.07(4.93) \\
&= 3.65
\end{split}
$$

<br />

**13. Create the density plot of the marginal distribution of the standardized residuals from the ANCOVA model. Add the confidence envelope for the normal distribution. Explain whether or not this plot suggests problems about meeting the normality assumption.**

```{r}
#| label: fig-question-13
#| fig-cap: "Density plot of the distribution of standardized residuals. A confidence envelope for the distribution assuming normality is also included."
# Augment results
out_2 = augment(lm.2)

# Density plot
ggplot(data = out_2, aes(x = .std.resid)) +
  stat_density_confidence(model = "normal") +
  stat_density(geom = "line") +
  theme_bw()  +
  xlab("Standardized residuals") +
  ylab("Probability density")
```

Based on the plot, the data look *mostly* consistent with meeting the assumption. There is, however, deviation from marginal normality at standardized residual values slightly higher than 0 and at values around $-1.5$.


<br />

**14. Create the scatterplot of the standardized residuals versus the fitted values from the ANCOVA model. Include any smoothers or confidence envelopes that will allow you to evaluate the linearity assumption. In the plot identify observation with extreme residuals ($\leq-3$ or $\geq3$) by indicating  the row number of that observation in the plot.**


```{r}
#| label: fig-question-14
#| fig-cap: "Scatterplot of the standardized residuals versus the fitted values. The line $y=0$ and the confidence envelope showing the expected uncertainty from that line are also displayed on the plot, along with a loess smoother. Observations with a standardized residual more than three standard errors from 0 are also identified by their row number in the data."
# Augment results
out_2 = out_2 |>
  mutate(ID = 1:nrow(out_2))

# Identify extreme and non-extreme observations
extreme = out_2 |>
  filter(.std.resid > 3 | .std.resid < -3)

nonextreme = out_2 |>
  filter(.std.resid <= 3 & .std.resid >= -3)

# Create scatterplot
ggplot(data = nonextreme, aes(x = .fitted, y = .std.resid)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = TRUE) +
  geom_smooth(method = "loess", se = FALSE) +
  geom_hline(yintercept = c(-3, 3), linetype = "dashed") +
  geom_text(data = extreme, aes(label = ID), color = "red", size = 6) +
  theme_bw() +
  xlab("Fitted values") +
  ylab("Standardized residuals")
```

<br />

**15. Explain whether or not this plot suggests problems about meeting the linearity and homogeneity of variance assumptions.**

The linearity assumption seems satisfied as mean residual at each fitted value is zero, with roughly equal numbers of observations above and below 0 at each fitted-value. (There is some devation of the loess smoother outside the confidence envelope neat fitted values of 3.8 that might be indicative of some nonlinearity. The deviation at the extreme high fitted values is likely due to te single observation with a fitted value near 4.5 and is not cause for concern.) The homogeneity of variance assumption also seems reasonably satisfied since the variation in the residuals is roughly the same at each fitted value.

<br />
